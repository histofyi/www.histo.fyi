{% extends "base.html" %}

{% set nav = 'structures' %}

{% block main %}
<style>
    
    a.no-decoration {
        text-decoration: none;
    }
    div.chain_block {
        border-left: 7px solid #888888;
        padding-left: 10px;
    }

    div.peptide {
        border-left-color: #F5E54B;
    }

    div.class_i_alpha {
        border-left-color: #61927E;
    }

    div.beta2m {
        border-left-color: #E1935B;
    }

    div.tcr_alpha {
        border-left-color: #96C45E;
    }
    div.tcr_gamma {
        border-left-color: #96C45E;
    }
    div.tcr_beta {
        border-left-color: #DA4EA9;
    }
    div.tcr_delta {
        border-left-color: #DA4EA9;
    }
    a.superscript {
            position: relative; 
            top: -0.5em; 
            font-size: 80%; 
    }
</style>

<section class="">
    <div class="grid-container">
        <div class="column-full-width">
            <small><strong>{{structure.pdb_code|upper}}</strong></small>
            <h1 class="heading-large vertical-spacing-bottom structure-title">{{structure|full_structure_title|safe}}</h1>
        </div>
        <div class="column-two-thirds">
            <div class="inner">
                {% include "structure/full_structure_display.html" %}
            </div>
            <h2 class="heading-small vertical-spacing-top-0-5">Structure notes</h2> 
            <div class="inner"><small>Structure downloaded from PDB Europe using the Coordinate Server<a class="superscript" href="#1">1</a>. Aligned to residues 1-180 of 1HHK<a class="superscript" href="#2">2</a> with an RMSD of [] using the CEALIGN<a class="superscript" href="#3">3</a> function of PyMol<a class="superscript" href="#4">4</a>. Chains assigment using a Levenshtein distance<a class="superscript" href="#5">5</a> method using data from the PDBe REST API. Organism data from PDBe REST API. Data for both of these operations from the Molecules endpoint.</small></div>

        </div>
        <div class="column-one-third">
            <div class="inner">
                <h3 class="vertical-spacing-top-0-5 heading-small">Chains in complex</h3>
                {% if structure.complex.label %}
                    <p>{{structure.complex.label}}</p>
                {% else %}
                    <p>Problems in automatic complex type assignment. Known issue being fixed.</p>
                {% endif %}
                {% for chain in structure.facets.chains %}
                {% set thischain = structure.facets.chains[chain] %}
                    <div class="vertical-spacing-bottom-0-25">
                        <div class="chain_block {{thischain.best_match.match}}">
                            <div>
                                <strong>{{chain}}.</strong> {{chain_types[thischain.best_match.match]['ui_text']}}
                                {% if thischain.best_match.match == 'class_i_alpha' %}
                                <br />
                                {{structure.allele.mhc_alpha}}
                                {% elif thischain.best_match.match == 'peptide' %}
                                <br />
                                {{structure.peptide.sequence}}
                                {% else %}
                                
                                {% endif%}
                            </div>
                            <div>
                                {{thischain.chains}}
                            </div>
                        </div>
                    </div>
                {% endfor %}
                <h3 class="vertical-spacing-top-0-5 heading-small">Organism</h3>
                <div>{{structure.organism.scientific_name}} ({{structure.organism.common_name}})</div>
                <h3 class="vertical-spacing-top-0-5 heading-small">Locus / Allele group</h3>
                <div class="vertical-spacing-bottom-0-5">
                    {{structure.locus}}
                    {% if structure.allele_group %}
                    / {{structure.allele_group.mhc_alpha}}
                    {% endif %}
                </div>

            </div>
        </div>
</div>
</section>

<section class="">
    <div class="grid-container">
        <div class="column-full-width">
            <div class="inner">
                <hr />
                <h2 class="heading-medium vertical-spacing-top-0-5">Publication</h2>    
            </div>
        </div>
        {% include "structure/publication_block.html" %}
        <div class="column-one-third">
            <p>Other structures from this publication</p>
            {% for associated_structure in associated_structures %}
            {% if associated_structure != pdb_code %}
            <p>
                <strong><a href="/structures/view/{{associated_structure}}">{{associated_structure | upper}}</a></strong>
                <br />
                {{ associated_structures[associated_structure]|short_structure_title|safe}}
            </p>
            {% endif %}
            {% endfor %}
        </div>
      </div>
    </div>
  </div>
</section>

<section class="">
    <div class="grid-container">
        <div class="column-full-width">
            <div class="inner">
                <hr />
                <h2 class="heading-medium vertical-spacing-top-0-5">Peptide</h2>    
                
            </div>
        </div>
        <div class="column-one-third">
        </div>
      </div>
    </div>
  </div>
</section>

<section class="">
    <div class="grid-container">
        <div class="column-full-width">
            <div class="inner">
                <hr />
                <h2 class="heading-medium vertical-spacing-top-0-5">Peptide neighbours</h2>    
                
            </div>
        </div>
        <div class="column-one-third">
        </div>
      </div>
    </div>
  </div>
</section>

<section class="">
    <div class="grid-container">
        <div class="column-full-width">
            <div class="inner">
                <hr />
                <h2 class="heading-medium vertical-spacing-top-0-5">Crystallography</h2>    
                {{structure.crystallography}}
            </div>
        </div>
        <div class="column-one-third">
        </div>
      </div>
    </div>
  </div>
</section>

<section class="vertical-spacing-top">
    <div class="grid-container">
        <div class="column-full-width">
            <div class="inner">
                <h4 class="heading-small vertical-spacing-bottom-0-25">Footnotes</h4>
                <ol>
                    <li><a name="1" class="no-decoration">Protein Data Bank Europe REST API</a> - <a href="https://www.ebi.ac.uk/pdbe/api/doc/" target="_new">Publication Method</a></li>
                </ol>
                
            </div>
        </div>
    </div>
</section>
<script src="https://cdnjs.cloudflare.com/ajax/libs/3Dmol/1.4.0/3Dmol-min.js"></script>

{% endblock %}